skip:
  url:
    - /admin/login
    - /admin/file/upload
    - /admin/get/validate/code
    - /app/user/add
    - /app/login
    - /web/qr/initQRCodeInfo
    - /web/index/getIndex
    - /web/index/searchNews
    - /web/dictionary/getDictionaryByCode
    - /web/qr/initQRCodeInfo

webauth:
  url:
    - /web/index/addBillboardGain
    - /web/collection/add
    - /web/collaborate/add
    - /web/user/center/queryMyPublish
    - /web/user/center/addMyBillboard
    - /web/user/center/updateMyBillboard
    - /web/user/center/addAppraise
    - /web/user/center/deleteMyBillboard
    - /web/attention/pageQuery
    - /web/attention/add
    - /web/collection/pageQuery
    - /web/collection/deleteById
    - /web/havest/pageQuery
    - /web/my/share/community/addlike
    - /web/my/share/community/getMyShareCommunityPages
    - /web/my/share/community/add
    - /web/tech/broker/getEconomicManRequires
    - /web/message/getMyMessages


appauth:
  url:
    - /app/index/addBillboardGain
    - /app/collection/add
    - /app/collaborate/add
    - /app/user/center/queryMyPublish
    - /app/user/center/addMyBillboard
    - /app/user/center/updateMyBillboard
    - /app/user/center/addAppraise
    - /app/user/center/deleteMyBillboard
    - /app/attention/pageQuery
    - /app/attention/add
    - /app/collection/pageQuery
    - /app/collection/deleteById
    - /app/havest/pageQuery
    - /app/my/share/community/addlike
    - /app/my/share/community/getMyShareCommunityPages
    - /app/my/share/community/add
    - /app/tech/broker/getEconomicManRequires
    - /app/message/getMyMessages




# Tomcat
server:
  port: 9527

# Spring
spring:
  application:
    # 应用名称
    name: gateway
  profiles:
    # 开发环境配置
    active: local

    # 测试环境
    #active: dev
  servlet:
    multipart:
      max-file-size: 50MB
      max-request-size: 100MB


  redis:
    # Redis数据库默认库索引
    database: 0
    # 服务器地址
    host: localhost
    # 端口
    port: 6379
    # 默认密码为空
    password: Antan!@#qwe
    # 连接超时时间
    timeout: 10000
    jedis:
      pool:
        # 连接池最大的连接数(负值表示没有限制)
        max-active: 200
        # 连接池最大的阻塞等待时间(负值表示没有限制)
        max-wait: -1
        # 连接池中的最大空闲连接
        max-idle: 100
        # 连接池中的最小空闲连接
        min-idle: 0

  main:
    allow-bean-definition-overriding: true
  cloud:
    nacos:
      discovery:
        # 服务注册地址
        #server-addr: 127.0.0.1:8848

        server-addr: 127.0.0.1:8848
      config:
        # 配置中心地址
        server-addr: 127.0.0.1:8848
        # 配置文件格式
        file-extension: yml

    gateway:
      globalcors: # 全局的跨域处理
        add-to-simple-url-handler-mapping: true # 因为ajax发起者会通过options请求来向服务器询问是否允许跨域，所以需要设置为true来解决options请求被拦截问题
        corsConfigurations:
          '[/**]':
            allowedOrigins: # 允许哪些网站的跨域请求
              - "http://localhost:8080"
              - "http://localhost:8081"
              - "http://localhost:8082"
            allowedMethods: # 允许的跨域ajax的请求方式
              - "GET"
              - "POST"
              - "DELETE"
              - "PUT"
              - "OPTIONS"
            allowedHeaders: "*" # 允许在请求中携带的头信息
            allowCredentials: true # 是否允许携带cookie
            maxAge: 360000 # 这次跨域检测的有效期，即一定时间内就不需要重复询问是否允许跨域了，直接请求即可。


      httpclient:
        connect-timeout: 10000
        response-timeout: 5s

      routes:
        - id: admin_route
          uri: http://localhost:8081
          predicates:
            - Path=/admin/**
          filters:
            - RewritePath=/admin/(?<path>.*), /$\{path}

        - id: app_route
          uri: http://localhost:8082
          predicates:
            - Path=/app/**
          filters:
            - RewritePath=/app/(?<path>.*), /$\{path}

        - id: web_route
          uri: http://localhost:8080
          predicates:
            - Path=/web/**
          filters:
            - RewritePath=/web/(?<path>.*), /$\{path}

          # 在metadata中设置单个路由超时时间
          metadata:
            response-timeout: 5000
            connect-timeout: 5000


      feign:
        httpclient:
          enabled: true
          connection-timeout: 90000

      ribbon:
        # 指的是建立连接后从服务器读取到可用资源所用的时间
        ReadTimeout: 90000
        # 指的是建立连接所用的时间，适用于网络状况正常的情况下，两端连接所用的时间
        ConnectTimeout: 90000
        MaxAutoRetries: 0
        MaxAutoRetriesNextServer: 1
